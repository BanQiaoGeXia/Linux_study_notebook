<font size=4 color=green face="微软雅黑">

# 可移植性问题

---

## 1. 特性测试宏

+ 系统调用和库函数QPI的行为受各种标准的制约,
	+ Open Groups (SUS) 这样的标准机构来制定的
	+ 具有重要历史意义的两个UNIX实现 BSD和System V Release 4 

+ 编写可移植性应用程序时, 有事会希望各个头文件只显露遵循特定标准的定义, 需要在编译时定义一个或多个特性测试宏:
	+ 在程序源码包含任何头文件之前, 定义:
			# define _BSD_SOURCE
	
	+ 使用C编译器的-D选项
			
			$ cc -D_BSD_SOURCE prog.c

+ 特性测试宏:
		
		通过测试(使用 #if)应用程序为宏所定义的值, 实现可以决定应该让那些由头文件提供的特性可见

+ 以下特性测试宏由相关标准定义围城, 因而在支持这些标准的所有系统上, 对这些宏的使用都是可移植的:
	
名称|定义
-|-
_POSIX_SOURCE|已被_POSIC_C_SOURCE取代|
_POSIX_C_SOURCE|定义为1, 头文件汇贤楼符合 POSIX.1-1990 和 ISO C(1990)标准定义. <br>定义为大于 199309, 头文件还会显露村从 POSIX.1b(实时) 标准的定义, <br>若定义为大于定于199506, 变回开启对POSIX.1c(线程)定义的支持, <br>若定义为200112, 则开启对POSIX.1-2001基本规范(排除了XSI扩展)定义的支持. <br>若定义为200809, 会开启对POSIX.1-2008 基本规范定义的支持|
_XOPEN_SOURCE|一经定义, 头文件会显露对 POSIX.1/POSIX.2和X/Open(XPG4)标准的定义, <br>若大于等于500, 还会对SUSv2(UNIX98和XPG5)扩展的支持, <br>若大于等于600, 开启对SUSv3 XSI(UNIX 03)扩展和C99扩展的支持, <br>若大于等于700, 会开启对SUSv4 XSI扩展的支持|

+ glibc专用的特性测试宏

名称|定义
-|-
_SBD_SOURCE|一经定义, 开启对BSD定义的支持, 另外, 只要定义了该宏, 便以值199506定义了_POSIX_C_SOURCE, 当标准之间发生冲突是, 显示设置该宏会导致BSD定义倾斜|
_SVID_SOURCE|头文件会显露符合System V 接口规范(SVID)的定义|
_GNU_SOURCE|一经定义, 头文件会现楼符合前述所有标准的定义, 以及开启对各种GNU扩展定义的支持.
_POSIX_C_SOURCE|在POSIX.1-2001/SUSv3 中, 进队_POSIX_C_SOURCE和_XOPEN_SOURCE特性测试宏进行了明确定义, 应用程序要符合该标准, 应分别将上述两个宏定义为200112和600. <br>将_POSIX_C_SOURCE值定义为200112, 表示应用程序符合POSIX.1-2001基本规范. <br>将_XOPEN_SOURCE定义为600, 即表示应用程序符合SUSv3规范|
_XOPEN_SOURCE|同上|
POSIX.1/SUS|同上|

## 2. 系统数据类型


## 3. 其他可移植性问题